### CPU

- 산술 논리 연산장치, 제어장치, 레지스터로 구성되어 있다.
- 이들의 협업을 통해 작업들을 수행한다.

  - 산술 논리 연산장치
    - 주로 데이터의 산술 연산, 논리 연산(AND, OR..)을 담당한다.
  - 제어 장치
    - CPU에서 작업을 지시하는 역할을 맡는다.
  - 레지스터
    - CPU에서 임시로 저장하는 공간을 맡는다.

두 변수를 선언하고, 값을 더하는 함수를 작성했을 때 실행하게 되면
```java
int a = 3;
int b = 4;
int sum = a + b;
```
레지스터에 3과 4를 저장하고, 제어장치에서는 이 두 수를 저장하고, 덧셈해서 결과값을 레지스터에 저장하라 라는 명령들을 보낸다.
그에 맞춰서 산술 논리 연산장치는 두 수를 더하고 결과를 가져오게 된다. 
메모리 구조에서는 3, 4 그리고 결과값 7이 레지스터에 저장되어 있다. (메모리 번지수 어딘가에)

이 레지스터의 종류도 있다.

### 레지스터 종류

방금 3과 4를 저장함과 그 결과값을 저장한 7의 값은 데이터 레지스터(DR)이라 한다.
그리고 데이터나 명령어도 저장한다. 레지스터에. 그 레지스터를 주소 레지스터(AR)라 한다.
- 데이터 레지스터 
  - 메모리에서 가져온 데이터를 임시 보관할 때 사용한다.
- 주소 레지스터
  - 데이터나 명령어가 저장된 레지스터

이 두 개의 레지스터는 사용자에 따라 바뀔 수 있기 때문에 가시 레지스터라 불리운다.

사용자에 따라 바뀔 수 없는 레지스터가 있는데, 이를 특수 레지스터라 부른다. 또는 사용자 불가 레지스터라고도 한다.

- 프로그램 카운터
  - CPU는 이 다음에 어떤 명령어를 수행할지 알아야 한다. 다음에 실행할 명령어의 주소를 기억했다가 제어장치에 알려야 한다.
  이의 역할을 해주는 것을 프로그램 카운터라 불리운다.
- 명령어 레지스터
  - 현재 실행 중인 명령어를 저장한다.
- 메모리 주소 레지스터 
  - 메모리에서 데이터를 가져오거나 반대로 메모리로 데이터를 보낼 때 주소를 지정하기 위해 사용한다.
- 메모리 버퍼 레지스터
  - 메모리에서 가져온 데이터나 메모리로 옮겨 갈 데이터를 임시로 저장한다. 
  - 때문에 항상 메모리 주소 레지스터와 함께 움직인다.

이 외에도 더 많은 레지스터들이 있지만, 일단 이정도로만 알아도..

### 버퍼와 캐시

버퍼는 두 장치 사이에서 속도 차이가 있는 것을 완화하는 역할을 뜻한다.

CPU와 메모리, 다른 장치들의 속도 차이가 제각각이고 속도를 맞추기도 어렵다. 그래서 이를 개선하기 위해 나온 개념이 바로 버퍼이다.

하드웨어적만이 아니라 소프트웨어에서도 버퍼의 개념이 사용된다. 대표적인 예시로는 동영상 버퍼링이 있다. 
동영상이 재생될 만큼 버퍼를 해서 일정량의 영상 길이를 미리 가져오고, 사용자가 그 영상을 시청하게끔 할 수 있는 개념이 바로 그것이다.

캐시는 메모리와 CPU간의 속도 차이를 완화하기 위해 메모리의 데이터를 미리 가져와 사용하는 임시 장소이다.

CPU가 사용할 것으로 예상되는 데이터를 미리 가져오는 것이 핵심이다. 캐시는 메모리에서 일부를 미리 가져오고, CPU는 메모리에 접근할 때 캐시를 먼저 방문해서
원하는 데이터가 있는지 확인한다. 여기에서 원하는 데이터를 찾았다면, 바로 가져오는데 이를 캐시 히트라 한다.
반대로 찾지 못했다면 캐시 미스라 하며, 캐시 히트율은 90퍼센트 이상이라 한다.

물론 캐시도 소프트웨어에서도 많이 사용되는 예시이다. 예를 들어서, JPA 에서 배웠던 영속성 컨텍스트라던지 ? 아니면 웹 브라우저 캐싱의 개념도 캐시이다.
이 웹 브라우저 캐시도 이미지들이라던지, 캐시 공간에 저장해 두어 사용자가 또 그 웹 브라우저를 들어갔을 때 캐시 데이터에서 가져오게 되는 데에 있어 아주 좋다.

하지만 이 캐시 공간도 무한대는 아니기 때문에 간간히 청소를 해주어야만이 효율적으로 사용할 수 있을 것이다.

### 캐시 Update

캐시에 있는 데이터를 변경되는 경우 반영하는 데에서 이슈가 있다.

캐시는 메모리에 있는 데이터를 임시로 가져온 것이다. 캐시에 있는 데이터가 변경되면 원본 데이터를 변경해야만 한다.

이를 해결하기 위해 두 가지 방식이 존재한다.

- 즉시 쓰기
  - 캐시에 있는 데이터가 변경되면 곧바로 메모리에 반영하는 방식이다.
  - 메모리와 빈번한 데이터의 전송으로 인해 성능이 느려진다는 것이 단점이나, 급작스런 에러나 오류로 인해 데이터가 날아가도
  최신 값을 항상 유지하기 때문에 데이터를 잃어버릴 확률이 적다.
- 지연 쓰기
  - 캐시에 있는 데이터가 변경되면 데이터를 주기적으로 모아서 때가 되면 변경하는 방식이다.
  - 메모리와 전송 횟수가 상대적으로 적어 성능이 향상된다는 것이 장점이다.
  - 하지만 메모리와 캐시의 데이터 정합성이 깨질 우려가 있다.


캐시에도 종류가 있다.

### 캐시 종류

L1, L2 캐시라 부른다.

명령어 캐시와 데이터 캐시가 있다. 명령어 캐시는 명령어 레지스터와 연경되어 있고, 데이터 캐시는 데이터 레지스터와 연결되어 있다.

명령어, 데이터 캐시는 CPU 레지스터에 직접 연결되기 때문에 L1 캐시라고 부르며, 일반 캐시는 메모리와 연결되기 때문에 L2 캐시라 부른다.

